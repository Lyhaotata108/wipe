/*!db-wipe 1.0.0 发布日期:2018-11-12*/
var cas=document.getElementById("cas"),context=cas.getContext("2d"),_w=cas.width,_h=cas.height,pox=0,poY=0,radius=20,insMouseDown=!1,att=0;function drawRect(t){t.fillStyle="#666",t.fillRect(0,0,_w,_h),t.globalCompositeOperation="destination-out"}function drawPoint(t,e,n){t.save(),t.beginPath(),t.arc(e,n,30,0,2*Math.PI),t.fillStyle="red",t.fill(),t.stroke()}function drawLine(t,e,n,o,a){t.save(),t.lineCap="round",t.beginPath(),t.moveTo(e,n),t.lineTo(o,a),t.lineWidth=2*radius,t.stroke(),t.restore()}function fn1(t){if(1==insMouseDown){var e=t||window.event,n=e.clientX,o=e.clientY;drawLine(context,pox,poY,n,o),pox=n,poY=o}}function clearRect(t){t.clearRect(0,0,_w,_h)}function getTransparencyPercent(t){for(var e=t.getImageData(0,0,_w,_h),n=0;n<e.data.length;n+=4){0==e.data[n+3]&&att++}console.log("透明点的个数:"+att);var o=att/(_w*_h)*100;return console.log("占总面积"+Math.ceil(o)+"%"),Math.round(o)}cas.addEventListener("mousedown",function(t){var e=t||window.event;insMouseDown=!0,pox=e.clientX,poY=e.clientY,drawPoint(context,pox,poY)},!1),cas.addEventListener("mousemove",fn1,!1),cas.addEventListener("mouseup",function(t){insMouseDown=!1,50<getTransparencyPercent(context)&&(alert("超过了50%的面积"),clearRect(context))},!1),window.onload=function(){drawRect(context)};